{% load static %}
<!DOCTYPE html>
  <html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>SkillHub</title>
      <link rel="icon" type="image/x-icon" href="{% static 'images/favicon.ico' %}">
      <link rel="stylesheet" href="{% static 'css/base.css' %}">
  </head>
  <body>
      <nav>
          <a href="{% url 'main_app:home' %}" class="nav-brand">
            <img src="{% static 'images/logo.png' %}" alt="SkillHub" class="logo">
            <h1>SkillHub</h1>
          </a>
          
          <!-- Mobile menu toggle button -->
          <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle navigation menu">
              <span class="hamburger-line"></span>
              <span class="hamburger-line"></span>
              <span class="hamburger-line"></span>
          </button>
          
          <!-- Navigation menu -->
          <div class="nav-menu" id="navMenu">
              <ul>
                    <li><a href="/" class="nav-link">Home</a></li>
                    {%if user.is_authenticated %}
                        <li><a href="{% url 'main_app:skills_list' %}" class="nav-link">Skills</a></li>    
                        <li><a href="{% url 'main_app:projects_list' %}" class="nav-link">Projects</a></li>
                        <li class="profile-dropdown">
                            <div class="profile-trigger">
                                <div class="profile-avatar">
                                    {% if user.first_name %}
                                        {{ user.first_name.0 }}{{ user.last_name.0 }}
                                    {% else %}
                                        {{ user.username.0 }}
                                    {% endif %}
                                </div>
                                <span class="profile-name">
                                    {% if user.first_name %}
                                        {{ user.first_name }}
                                    {% else %}
                                        {{ user.username }}
                                    {% endif %}
                                </span>
                                <span class="dropdown-arrow">â–¼</span>
                            </div>
                            <div class="dropdown-menu">
                                <a href="{% url 'main_app:profile' %}" class="dropdown-item">
                                    <span class="dropdown-icon">
                                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                                        </svg>
                                    </span> View Profile
                                </a>
                                <a href="{% url 'main_app:profile_edit' %}" class="dropdown-item">
                                    <span class="dropdown-icon">
                                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                        </svg>
                                    </span> Edit Profile
                                </a>
                                <a href="{% url 'main_app:change_password' %}" class="dropdown-item">
                                    <span class="dropdown-icon">
                                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                                        </svg>
                                    </span> Change Password
                                </a>
                                <div class="dropdown-divider"></div>
                                <a href="{% url 'main_app:delete_account' %}" class="dropdown-item danger">
                                    <span class="dropdown-icon">
                                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                        </svg>
                                    </span> Delete Account
                                </a>
                                <div class="dropdown-divider"></div>
                                <a href="{% url 'main_app:logout' %}" class="dropdown-item">
                                    <span class="dropdown-icon">
                                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                                        </svg>
                                    </span> Logout
                                </a>
                            </div>
                        </li>
                    {% else %}
                        <li><a href="{% url 'main_app:login' %}" class="nav-link">Login</a></li>
                        <li><a href="{% url 'main_app:signup' %}" class="nav-link">Sign Up</a></li>
                    {% endif %}
              </ul>
          </div>
      </nav>

      <!-- messages section -->
      {% if messages %}
        <div class="messages-container">
            {% for message in messages %}
              <div class="alert alert-{{ message.tags }}">
                  {{ message }}
                  <button type="button" class="close-btn" onclick ="this.parentElement.style.display='none'">&times;</button>
              </div>
            {% endfor %}
        </div>
      {% endif %}

      <main>
          {% block content %}
          {% endblock %}
      </main>
      
      <script>
          // Mobile navigation menu toggle
          document.addEventListener('DOMContentLoaded', function() {
              const mobileMenuToggle = document.getElementById('mobileMenuToggle');
              const navMenu = document.getElementById('navMenu');
              
              if (mobileMenuToggle && navMenu) {
                  mobileMenuToggle.addEventListener('click', function() {
                      navMenu.classList.toggle('active');
                      mobileMenuToggle.classList.toggle('active');
                      
                      // Toggle aria-expanded for accessibility
                      const isExpanded = navMenu.classList.contains('active');
                      mobileMenuToggle.setAttribute('aria-expanded', isExpanded);
                  });
                  
                  // Close mobile menu when clicking on nav links
                  const navLinks = navMenu.querySelectorAll('.nav-link');
                  navLinks.forEach(link => {
                      link.addEventListener('click', function() {
                          navMenu.classList.remove('active');
                          mobileMenuToggle.classList.remove('active');
                          mobileMenuToggle.setAttribute('aria-expanded', 'false');
                      });
                  });
                  
                  // Close mobile menu when clicking outside
                  document.addEventListener('click', function(event) {
                      const isClickInsideNav = navMenu.contains(event.target) || mobileMenuToggle.contains(event.target);
                      if (!isClickInsideNav && navMenu.classList.contains('active')) {
                          navMenu.classList.remove('active');
                          mobileMenuToggle.classList.remove('active');
                          mobileMenuToggle.setAttribute('aria-expanded', 'false');
                      }
                  });
              }
              
              // Profile dropdown functionality
              const profileDropdown = document.querySelector('.profile-dropdown');
              if (profileDropdown) {
                  const profileTrigger = profileDropdown.querySelector('.profile-trigger');
                  const dropdownMenu = profileDropdown.querySelector('.dropdown-menu');
                  
                  if (profileTrigger && dropdownMenu) {
                      profileTrigger.addEventListener('click', function(e) {
                          e.stopPropagation();
                          profileDropdown.classList.toggle('active');
                      });
                      
                      // Close dropdown when clicking outside
                      document.addEventListener('click', function(event) {
                          if (!profileDropdown.contains(event.target)) {
                              profileDropdown.classList.remove('active');
                          }
                      });
                  }
              }
          });
      </script>
  </body>
  </html>