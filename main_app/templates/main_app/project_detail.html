{% extends 'main_app/base.html' %}

{% block content %}
<div class="detail-container">
    <h2>{{ project.title }}</h2>
    <p><strong>Description:</strong> {{ project.description }}</p>
    <p><strong>Progress:</strong> {{ project.progress }}%</p>

    <div class="progress-bar">
        <div class="progress-fill" style="width: {{ project.progress }}%"></div>
    </div>

    <div class="project-actions">
        <a href="{% url 'main_app:project_edit' project.id %}" class="btn-edit">Edit Project</a>
        <a href="{% url 'main_app:projects_list' %}" class="btn-secondary">Back to Projects</a>
    </div>

    <h3>Tasks</h3>
    <a href="{% url 'main_app:task_create_for_project' project.id %}" class="btn-primary">Add Task</a>

    {% if tasks %}
        <ul class="task-list">
        {% for task in tasks %}
            <li class="task-item {% if task.is_completed %}completed{% endif %}">
                <div class="task-content">
                    <h4>{{ task.title }}</h4>
                    <p>{{ task.description }}</p>
                </div>
                <div class="task-actions">
                    <a href="{% url 'main_app:task_toggle' task.id %}" class="btn-toggle">
                        {% if task.is_completed %}✓ Mark Incomplete{% else %} ○ Mark Complete{% endif %}
                    </a>
                    <a href="{% url 'main_app:task_edit' task.id %}" class="btn-edit">Edit</a>
                    <a href="{% url 'main_app:task_delete' task.id %}" class="btn-delete">Delete</a>
                </div>
            </li>
        {% endfor %}
        </ul>
    {% else %}
        <p>No tasks added yet.</p>
    {% endif %}



    <h3>Reflections</h3>
    <a href="{% url 'main_app:reflection_create_for_project' project.id %}" class="btn-primary">Add Reflection</a>

    {% if reflections %}  
        <div class="reflections-list">
        {% for reflection in reflections %}
            <div class="reflection-item">
                <div class="reflection-content">
                    <p>{{ reflection.content }}</p>
                </div>
                <div class="reflection-date">
                    <small>{{ reflection.date|date:"M d, Y at H:i" }}</small>
                    <div class="reflection-actions">
                        <a href="{% url 'main_app:reflection_edit' reflection.id %}" class="btn-edit">Edit</a>
                        <a href="{% url 'main_app:reflection_delete' reflection.id %}" class="btn-delete">Delete</a>
                    </div>
                </div>
            </div>
        {% endfor %}
        </div>
    {% else %}
        <p>No reflections added yet.</p>
    {% endif %}

</div>
{% endblock %}