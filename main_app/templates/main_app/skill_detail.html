{% extends 'main_app/base.html' %}

{% block content %}
<div class="detail-container">
    <div class="detail-layout">
        <!-- Left Column: Details + Reflections -->
        <div class="detail-left">
            <div class="detail-info">
                <h2>{{ skill.title }}</h2>
                <p><strong>Category:</strong> {{ skill.category | default:"No category"}}</p>
                <p><strong>Description:</strong> {{ skill.description }}</p>
                <p><strong>Progress:</strong> {{ skill.progress }}%</p>

                <div class="progress-bar">
                    <div class="progress-fill" style="width: {{ skill.progress }}%"></div>
                </div>

                <div class="skill-actions">
                    <a href="{% url 'main_app:skill_edit' skill.id %}" class="btn-edit">Edit Skill</a>
                    <a href="{% url 'main_app:skills_list' %}" class="btn-secondary">Back to Skills</a>
                </div>
            </div>

            <div class="detail-reflections">
                <h3>Reflections</h3>
                <a href="{% url 'main_app:reflection_create_for_skill' skill.id %}" class="btn-primary">Add Reflection</a>

                {% if reflections %}
                    <div class="reflections-list">
                    {% for reflection in reflections %}
                        <div class="reflection-item">
                            <div class="reflection-content">
                                <p>{{ reflection.content }}</p>
                            </div>
                            <div class="reflection-date">
                                <small>{{ reflection.date|date:"F j, Y \a\t g:i A" }} </small>
                                <div class="reflection-actions">
                                    <a href="{% url 'main_app:reflection_edit' reflection.id %}" class="btn-edit">Edit</a>
                                    <a href="{% url 'main_app:reflection_delete' reflection.id %}" class="btn-delete">Delete</a>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                    </div>
                {% else %}
                    <div class="empty-state">
                        <p>No reflections added yet. Add a reflection to capture your learning insights!</p>
                    </div>
                {% endif %}
            </div>
        </div>

        <!-- Right Column: Tasks -->
        <div class="detail-right">
            <div class="detail-tasks">
                <h3>Tasks</h3>
                <a href="{% url 'main_app:task_create_for_skill' skill.id %}" class="btn-primary">Add Task</a>
                {% if tasks %}
                    <ul class="task-list">
                    {% for task in tasks %}
                        <li class="task-item {% if task.is_completed %}completed{% endif %}">
                            <div class="task-content">
                                <h4>{{ task.title }}</h4>
                                <p>{{ task.description }}</p>
                            </div>
                            <div class="task-actions">
                                <div class="task-toggle-action">
                                    <a href="{% url 'main_app:task_toggle' task.id %}" class="btn-toggle">
                                        {% if task.is_completed %}✓ Mark Incomplete{% else %}○ Mark Complete{% endif %}
                                    </a>
                                </div>
                                <div class="task-edit-actions">
                                    <a href="{% url 'main_app:task_edit' task.id %}" class="btn-edit">Edit</a>
                                    <a href="{% url 'main_app:task_delete' task.id %}" class="btn-delete">Delete</a>
                                </div>
                            </div>
                        </li>
                    {% endfor %}
                    </ul>
                {% else %}
                    <div class="empty-state">
                        <p>No tasks added yet. Create your first task to start tracking progress!</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}